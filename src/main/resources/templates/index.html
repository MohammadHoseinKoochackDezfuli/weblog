<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØ¨Ù„Ø§Ú¯</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<header id="header"></header>

<section class="hero">
    <h1>Ø¨Ù‡ ÙˆØ¨Ù„Ø§Ú¯ Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒ ðŸ‘‹</h1>
    <p>Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø¨ÛŒÙ† <span id="number"></span> Ù…Ù‚Ø§Ù„Ù‡ Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒ.</p>
    <div class="search-box">
        <input id="searcher" type="text" placeholder="Ú†ÛŒ Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ Ø¨Ø®ÙˆÙ†ÛŒØŸ">
        <button onclick="SEARCH()">ðŸ”Ž</button>
    </div>
</section>

<section id="search" style="display:none;" class="container">
    <h2 id="searchName"></h2>
    <div id="searchResult"></div>
</section>

<section class="container">
    <h2>ðŸ“‚ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h2>
    <div id="categories"></div>
</section>

<section class="container">
    <h2>ðŸ†• Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</h2>
    <div id="newWeblogs"></div>
</section>

<section class="container">
    <h2>ðŸ”¥ Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯ØªØ±ÛŒÙ† ÙˆØ¨Ù„Ø§Ú¯â€ŒÙ‡Ø§</h2>
    <div id="moreView"></div>
</section>

<footer id="footer"></footer>

<script src="/footerMaker.js"></script>
<script src="/headerMaker.js"></script>
<script src="/worker.js"></script>
<script>
    var searcher=document.getElementById("searcher");
    searcher.onkeypress=function (e) {
        if(e.key=="Enter") SEARCH();
    }

    fetch("http://localhost:8083/posts/count")
        .then(res => res.text())
        .then(res=> document.getElementById("number").innerHTML="+"+round(res));

    fetch("http://localhost:8083/categories/findAll")
        .then(res=>res.json())
        .then(res=>{
            document.getElementById("categories").innerHTML=listCategoryMaker(res);
        });

    fetch("http://localhost:8083/posts/findTop4ByOrderByCreatedAtDesc")
        .then(res=>res.json())
        .then(res=>{
            document.getElementById("newWeblogs").innerHTML=listPostMaker(res);
        });

    fetch("http://localhost:8083/posts/findTop4ByOrderByViewsDesc")
        .then(res=>res.json())
        .then(res=>{
            document.getElementById("moreView").innerHTML=listPostMaker(res);
        });

    function SEARCH() {
        var search=searcher.value;
        if(search=="") return;
        document.getElementById("search").style.display="block";
        document.getElementById("searchName").innerHTML="Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ "+search;
        document.getElementById("searchResult").innerHTML="Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...";
        fetch("http://localhost:8083/posts/findByTitleContaining?search="+search)
            .then(res=>res.json())
            .then(res=>{
                var result=listPostMaker(res);
                if(res.length==0) result="Ø¨Ø¯ÙˆÙ† Ù†ØªÛŒØ¬Ù‡";
                document.getElementById("searchResult").innerHTML=result;
            });
    }
</script>
</body>
</html>
