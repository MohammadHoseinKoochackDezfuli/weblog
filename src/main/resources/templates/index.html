<!DOCTYPE html>
<html lang="fa" dir="rtl" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØ¨Ù„Ø§Ú¯</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<header id="header"></header>
<div class="container">
    <center>
        <div class="logo" style="font-size: 60px;">
            <span>W</span><span>e</span><span>b</span><span>l</span><span>o</span><span>g</span>
        </div>
        <br>
        <br>
        <p>Ø¬Ø³ØªØ¬Ùˆ Ù…ÛŒØ§Ù† <span id="number"></span> ÙˆØ¨Ù„Ø§Ú¯</p>
        <div style="width: 200px;display: flex;height: 30px;">
            <div onclick="SEARCH();" style="width: 30px;background-color: blue;border: 2px solid blue;">ðŸ”Ž</div>
            <input id="searcher" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ù…Ù‚Ø§Ù„Ù‡" style="width: 170px;background-color: transparent;border: 2px solid blue;">
        </div>
        <div id="search" style="display: none;">
            <br>
            <br>
            <h2 id="searchName"></h2>
            <div id="searchResult"></div>
        </div>
        <br>
        <br>
        <h2>Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ù‡Ø§</h2>
        <div id="categories"></div>
        <br>
        <br>
        <h2>Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† ÙˆØ¨Ù„Ø§Ú¯ Ù‡Ø§</h2>
        <div id="newWeblogs"></div>
        <br>
        <br>
        <h2>Ù¾Ø±Ø¨Ø§Ø²Ø¯ÛŒØ¯ØªØ±ÛŒÙ† ÙˆØ¨Ù„Ø§Ú¯ Ù‡Ø§</h2>
        <div id="moreView"></div>
    </center>
</div>
<footer id="footer"></footer>
<script src="/footerMaker.js"></script>
<script src="/headerMaker.js"></script>
<script src="/worker.js"></script>
<script>
    var searcher=document.getElementById("searcher");
    searcher.onkeypress=function (e)
    {
        if(e.key=="Enter")
        {
            SEARCH();
        }
    }
    fetch("http://localhost:8083/posts/count")
        .then(res => res.text())
        .then(res=>{
            document.getElementById("number").innerHTML="+"+round(res);
        })
    fetch("http://localhost:8083/categories/findAll")
    .then(res=>res.json())
    .then(res=>{
        document.getElementById("categories").innerHTML=listCategoryMaker(res);
    })
    fetch("http://localhost:8083/posts/findTop4ByOrderByCreatedAtDesc")
        .then(res=>res.json())
        .then(res=>{
            document.getElementById("newWeblogs").innerHTML=listPostMaker(res);
        })
    fetch("http://localhost:8083/posts/findTop4ByOrderByViewsDesc")
    .then(res=>res.json())
    .then(res=>{
        document.getElementById("moreView").innerHTML=listPostMaker(res);
    })
    function SEARCH()
    {
        var search=searcher.value;
        if(search=="")
        {
            return;
        }
        document.getElementById("search").style.display="inline";
        document.getElementById("searchName").innerHTML="Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ "+search;
        document.getElementById("searchResult").innerHTML="loading...";
        fetch("http://localhost:8083/posts/findByTitleContaining?search="+search)
        .then(res=>res.json())
        .then(res=>{
            var result=listPostMaker(res);
            if(res.length==0)
            {
                result="Ø¨Ø¯ÙˆÙ† Ù†ØªÛŒØ¬Ù‡";
            }
            document.getElementById("searchResult").innerHTML=result;
        })
    }
</script>
</body>
</html>